import { ref, computed } from "vue";
import { defineStore } from "pinia";

export interface User {
  email: string;
  username: string;
  first_name: string;
  last_name: string;
  user_role: string;
  created_time: string;
  updated_time: string;
  active_time: string;
  confirmed: boolean;
  locked: boolean;
  guid: string;
}

export const useUserStore = defineStore("user", () => {
  const user = ref<User>();

  const isAdmin = computed(() => user.value?.user_role === "administrator");

  async function fetchCurrentUser() {
    const response = await fetch("api/user");
    const data = await response.json();

    user.value = data;
  }

  return {
    user,
    isAdmin,

    fetchCurrentUser,
  };
});
