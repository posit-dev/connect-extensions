<script setup lang="ts">
import VulnerabilityCard from "./VulnerabilityCard.vue";
import type { Vulnerability } from "../../stores/vulns";
import type { Package } from "../../stores/packages";

interface VulnerablePackageItem {
  packageInfo: Package;
  vulnerabilities: Vulnerability[];
  repo: "pypi" | "cran";
  latestFixedVersion: string | null;
}

defineProps<{
  vulnerablePackages: VulnerablePackageItem[];
}>();
</script>

<template>
  <div>
    <h3 class="mt-8 mb-4 text-lg text-gray-700">Vulnerable Packages</h3>

    <VulnerabilityCard
      v-for="(item, index) in vulnerablePackages"
      :key="index"
      class="not-last:border-b border-gray-300 not-last:pb-6 not-last:mb-6"
      :packageInfo="item.packageInfo"
      :vulnerabilities="item.vulnerabilities"
      :repo="item.repo"
      :latestFixedVersion="item.latestFixedVersion"
    />
  </div>
</template>
