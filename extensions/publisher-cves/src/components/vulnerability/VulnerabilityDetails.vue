<script setup lang="ts">
import { computed } from "vue";
import ArrowTopRight from "../icons/ArrowTopRight.vue";

const props = defineProps<{
  id: string;
  summary: string;
  details: string;
  publishDate: string;
  modifiedDate: string;
}>();

function formatDate(dateString: string): string {
  return new Date(dateString).toLocaleDateString();
}

const publishDate = computed(() => formatDate(props.publishDate));
const modifiedDate = computed(() => formatDate(props.modifiedDate));

function getOsvUrl(vulnId: string): string {
  return `https://osv.dev/vulnerability/${vulnId}`;
}
</script>

<template>
  <div>
    <div class="flex justify-between items-center mb-3">
      <p class="font-mono text-gray-500 text-sm m-0">
        <a
          :href="getOsvUrl(id)"
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-600 hover:text-blue-800 hover:underline inline-flex items-center"
        >
          {{ id }}
          <ArrowTopRight class="ml-1" />
        </a>
      </p>
    </div>

    <p class="text-base mb-3">
      <strong>{{ summary }}</strong>
    </p>
    <p
      class="text-sm text-gray-600 whitespace-pre-line break-words leading-relaxed bg-gray-50 p-3 rounded-md my-3"
    >
      {{ details }}
    </p>

    <div class="flex justify-between text-xs text-gray-500 mt-3">
      <span>Published: {{ publishDate }}</span>
      <span>Last Modified: {{ modifiedDate }}</span>
    </div>
  </div>
</template>
