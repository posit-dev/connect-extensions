<script setup lang="ts">
defineProps<{
  id: string;
  summary: string;
  details: string;
  fixedVersion: string | null;
  publishDate: string;
  modifiedDate: string;
}>();

function formatDate(dateString: string): string {
  return new Date(dateString).toLocaleDateString();
}

function getOsvUrl(vulnId: string): string {
  return `https://osv.dev/vulnerability/${vulnId}`;
}
</script>

<template>
  <div>
    <div class="flex justify-between items-center mb-3">
      <p class="font-mono text-gray-500 text-sm m-0">
        <a 
          :href="getOsvUrl(id)" 
          target="_blank" 
          rel="noopener noreferrer" 
          class="text-blue-600 hover:text-blue-800 hover:underline inline-flex items-center"
        >
          {{ id }}
          <span class="text-xs ml-1">â†—</span>
        </a>
      </p>
      <p v-if="fixedVersion" class="text-sm bg-green-50 text-gray-700 py-1 px-2 rounded m-0">
        <span class="text-gray-600 font-medium">Fixed in:</span> 
        <span class="font-bold text-green-700">v{{ fixedVersion }}</span>
      </p>
    </div>
    
    <p class="text-base mb-3"><strong>{{ summary }}</strong></p>
    <p class="text-sm text-gray-600 whitespace-pre-line break-words leading-relaxed bg-gray-50 p-3 rounded-md my-3">
      {{ details }}
    </p>
    
    <!-- Removed the fixedVersion message since it's now shown once at the package level -->
    
    <div class="flex justify-between text-xs text-gray-500 mt-3">
      <span>Published: {{ formatDate(publishDate) }}</span>
      <span>Last Modified: {{ formatDate(modifiedDate) }}</span>
    </div>
  </div>
</template>